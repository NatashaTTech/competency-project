passport related code adapted from Terrell Lemons' code